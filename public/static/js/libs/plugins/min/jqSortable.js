(function(d){var c,b,a;a=function(g,f,e){var h;h=g.clone();h.css(d.extend(f,{"z-index":e}));g.parent().append(h);return h};b=function(e){var g,f;f=e.outerWidth(true)-e.outerWidth();g=e.position();return{top:g.top,left:g.left+f}};c=(function(){function e(f){var g;g={context:"body",el:".sort-el",parent:"auto",close:true,closeTag:".sort-close",navs:{previous:".sort-previous",next:".sort-next"},disable:"dis",time:600,separator:",",input:null,id:"data-id",callback:{close:null}};this.settings=d.extend(g,f);this.context=d(this.settings.context);this.el=d(this.settings.el);this.flag=true;this.init()}e.prototype.init=function(){this.construct();this.animate()};e.prototype.construct=function(){var g,f,h;h=this;f=h.settings;g=h.el;d.each(g,function(j,m){var i,k,l;k=d(m).find(f.navs.next);l=d(m).find(f.navs.previous);if(f.close){i=d(m).find(f.closeTag);i.data("target",d(this))}d(this).data("next",k);d(this).data("previous",l);h.recognize.call(d(this),f.disable)})};e.prototype.recognize=function(f,i){var g,h;h=null;g=i||[];d.each(this,function(k,o){var m,j,l,n;h=d(o);m=h.data("next");n=h.data("previous");j=h.next();l=h.prev();m.add(n).removeClass(f).data("el",h);if(j.length>0&&d.inArray(j[0],g)===-1){m.data("target",h.next())}else{m.addClass(f)}if(l.length>0&&d.inArray(l[0],g)===-1){n.data("target",h.prev())}else{n.addClass(f)}})};e.prototype.animate=function(){var j,g,f,k,i,h,l;l=this;h=this.settings;i=h.navs;k=null;f=null;j=h.navs.next.replace(/[\.\s]/g,"");g={margin:0,position:"absolute"};l.context.on("click",i.previous+","+i.next,function(p){var m,q,n,o;p.preventDefault();if(l.flag){m=d(this).data("el");o=d(this).data("target");if(!d(this).hasClass(h.disable)){l.flag=false;n=b(o);q=b(m);k=a(m,d.extend(g,q),3);f=a(o,d.extend(g,n),2);m.add(o).css("visibility","hidden");k.animate({top:n.top,left:n.left},h.time,function(){m.css("visibility","visible");k.remove();l.flag=true});f.animate({top:q.top,left:q.left},h.time,function(){o.css("visibility","visible");f.remove()});if(d(this).hasClass(j)){o.insertBefore(m)}else{o.insertAfter(m)}l.recognize.call(l.el,h.disable,[k[0],f[0]]);if(l.settings.input!=null){l.el=d(l.settings.el).not(k.add(f));l.reorder()}}}});if(h.close){l.context.on("click",h.closeTag,function(n){var m;n.preventDefault();m=d(this).data("target");m.hide(500,function(){m.remove();l.el=d(h.el);l.recognize.call(l.el,h.disable);l.reorder();h.callback.close&&h.callback.close(m.attr(h.id))})})}};e.prototype.reorder=function(){var i,l,g,f,j,h,k;k=this;h=k.settings;i=k.el;g=d(h.input);l=null;f="";j="";d.each(i,function(m,n){l=d(n).attr(h.id);j=((m+1)===i.length?"":h.separator);f=f+l+j});g.val(f)};e.prototype.refresh=function(){var f;f=this;f.el=d(f.settings.el);f.construct();f.reorder()};return e})();d.extend({Sortablejs:function(e){return new c(e)}})})(jQuery);